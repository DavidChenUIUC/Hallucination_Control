12/29/2023 21:38:50 - INFO - __main__ - ***** Running training *****
12/29/2023 21:38:50 - INFO - __main__ -   Num examples = 14732
12/29/2023 21:38:50 - INFO - __main__ -   Num Epochs = 5
12/29/2023 21:38:50 - INFO - __main__ -   Instantaneous batch size per device = 4
12/29/2023 21:38:50 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 16
12/29/2023 21:38:50 - INFO - __main__ -   Gradient Accumulation steps = 4
12/29/2023 21:38:50 - INFO - __main__ -   Total optimization steps = 4605
  0%|                                                                                                                                             | 0/4605 [00:00<?, ?it/s]12/29/2023 21:38:50 - INFO - accelerate.accelerator - Loading states from exp_results/lr8e-5_decay0.1/step_200
12/29/2023 21:38:51 - INFO - accelerate.checkpointing - All model weights loaded successfully
|- Resuming from checkpoint
Resumed from checkpoint: exp_results/lr8e-5_decay0.1/step_200 path step_200
12/29/2023 21:38:53 - INFO - accelerate.checkpointing - All optimizer states loaded successfully
12/29/2023 21:38:53 - INFO - accelerate.checkpointing - All scheduler states loaded successfully
12/29/2023 21:38:53 - INFO - accelerate.checkpointing - All dataloader sampler states loaded successfully
12/29/2023 21:38:53 - INFO - accelerate.checkpointing - All random states loaded successfully
12/29/2023 21:38:53 - INFO - accelerate.accelerator - Loading in 0 custom states
  4%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã                                                                                                                             | 200/4605 [00:02<01:04, 68.24it/s]
Evaluating:   0%|                                                                                                                                  | 0/205 [00:00<?, ?it/s]

Evaluating:  40%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ                                                                        | 83/205 [00:36<00:37,  3.24it/s]
|- generated_tokens  ["Your task is to write a summarization for the following dialogue: 'Hannah: Hey, do you have Betty's number?\nAmanda: Lemme check\nHannah: <file_gif>\nAmanda: Sorry, can't find it.\nAmanda: Ask Larry\nAmanda: He called her last time we were at the park together\nHannah: I don't know him well\nHannah: <file_gif>\nAmanda: Don't be shy, he's very nice\nHannah: If you say so..\nHannah: I'd rather you texted him\nAmanda: Just text him üôÇ\nHannah: Urgh.. Alright\nHannah: Bye\nAmanda: Bye bye'  Sumation SumGhyD3($}}% 'ÔøΩÔøΩÔøΩÔøΩÔøΩabestanden)bL.$}}%riz.s(IABotllys_zT$}}%ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ$}}%~lQ~Y$}}%ÔøΩ archiv√°lva to get isÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ$}}%.ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ$}}%8$}}%.t' 'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩIABot Sum Sum[ –ú–µ–∫—Å–∏—á–∫–∞ ariz' SumE$}}% is ' her' willmMm$}}% andxz3 d√°tummal of her a SumÔøΩ$}}%3C{6IABot Sum'sÔøΩÔøΩÔøΩÔøΩabestandenÔøΩÔøΩÔøΩ$}}%.R7Xeltemperaturen2$}}%.ÔøΩÔøΩ$}}% SumÔøΩWebachivq$}}%3$}}%C[IABot a.'neltemperaturenM$}}%'rizÔøΩ$}}%B$}}% are7 d√°tummal.fh;hcIABot Sum' Sum'ÔøΩÔøΩÔøΩ$}}% Sum aN1.$}}%riz is SumI$}}% Sum'Rl$}}%.' ' ': Sumj$}}% Sum@)*$}}% SumÔøΩ$}}% Sum Sumic$}}% Sum and Sum.y$}}%fC archiv√°lva onationkm$}}% Sum Sumjq$}}% SumdyGIABot SumD^ d√°tummal Sum Sum' Sum-", "Your task is to write a summarization for the following dialogue: 'Eric: MACHINE!\r\nRob: That's so gr8!\r\nEric: I know! And shows how Americans see Russian ;)\r\nRob: And it's really funny!\r\nEric: I know! I especially like the train part!\r\nRob: Hahaha! No one talks to the machine like that!\r\nEric: Is this his only stand-up?\r\nRob: Idk. I'll check.\r\nEric: Sure.\r\nRob: Turns out no! There are some of his stand-ups on youtube.\r\nEric: Gr8! I'll watch them now!\r\nRob: Me too!\r\nEric: MACHINE!\r\nRob: MACHINE!\r\nEric: TTYL?\r\nRob: Sure :)'  sheation he going=yB@$}}% '  goingm the a  ': .'m.' will of for. on'ation going of. to.'ation' ' is at Sum  be 's on toation on' ' atation't of.' Sumriz ' going. for  'm.: ' ' a ' .s.'  a a'ation'  is to, ' Sum sheation to.' of. '  for. on's..' on: ' '. at ' a. tos a and. is' , ' , goingsation' onm and.' to ' of and the '  ' '  '  to's going. Sumation a ': ' a 's for.' for. the ination get.'s. Sum at: her.' 's from is to going the '  Sum of:.m and the with.' ': '  the'  ' ' ' will' 's the a: ' ': .' s's and: '..', Sum to ' is: ':  ' '.'s 's ' ' '  to' ' ' ' her a.'s ' ' '. 'm. be", "Your task is to write a summarization for the following dialogue: 'Lenny: Babe, can you help me with something?\r\nBob: Sure, what's up?\r\nLenny: Which one should I pick?\r\nBob: Send me photos\r\nLenny:  <file_photo>\r\nLenny:  <file_photo>\r\nLenny:  <file_photo>\r\nBob: I like the first ones best\r\nLenny: But I already have purple trousers. Does it make sense to have two pairs?\r\nBob: I have four black pairs :D :D\r\nLenny: yeah, but shouldn't I pick a different color?\r\nBob: what matters is what you'll give you the most outfit options\r\nLenny: So I guess I'll buy the first or the third pair then\r\nBob: Pick the best quality then\r\nLenny: ur right, thx\r\nBob: no prob :)'  is. '  is her to to and ' the is' ationrization for will is '.'  to ' to on ': going a  ' to.' srization riz to 's: ' : '  Sumation  will she's atationrization'  she '.  the is to.ation  and ' .' .'s the will . is.  ' ' '  ' . . in  the  arization:s' ation to.m:  ',.' a will '.:s  hasriz:ssation to.' . ' '  ' '  ' '  '.'  onm's:riz ' ia on '  '  ' is '.  ' ' '  '.'s riz.sriz 't  '. '. the is '  '  ' to: to' m: to '  ' ':'  ' '  ' '  ' '  ' '  ' '  ' ' ' .' '  the will.'  ' '  's ' '  ' '  '  ' ' '  ' ' '  and ' ' '  ' '", "Your task is to write a summarization for the following dialogue: 'Will: hey babe, what do you want for dinner tonight?\r\nEmma:  gah, don't even worry about it tonight\r\nWill: what do you mean? everything ok?\r\nEmma: not really, but it's ok, don't worry about cooking though, I'm not hungry\r\nWill: Well what time will you be home?\r\nEmma: soon, hopefully\r\nWill: you sure? Maybe you want me to pick you up?\r\nEmma: no no it's alright. I'll be home soon, i'll tell you when I get home. \r\nWill: Alright, love you. \r\nEmma: love you too. '  is ': ' Sum  ' rization to ' herÔøΩÔøΩÔøΩ$}}%m:  '  for a isriz ariz toation of'riz:m. the a Sum atriz ' a toation 'ss.t:s. the '.: will a the '.'  Sumrization to. was Sum ' 'm  '  a 'm andriz 'riz. at. '. and ' '.' 's. '.'  on in. onation aation for.': '  of be of. ' isation:ation. ' a. '  ' to '  's to is her is ' 's to : for with.' '. ':  are tos to 'm.' ' to 's: '  '' 'sation is at ' '  a.' to  has a is.'.'s.  her: ' ' ' Sum' ' '  ' a will. will ariz '  '  the with's '  on ' Sum 's for' will. is '.'.' ' of ' to ' '. ' ' ' is ' '  and ' '. '  's: ' '  's to '"]
|- single pred  ["Sumation SumGhyD3($}}% 'ÔøΩÔøΩÔøΩÔøΩÔøΩabestanden)bL.$}}%riz.s(IABotllys_zT$}}%ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ$}}%~lQ~Y$}}%ÔøΩ archiv√°lva to get isÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ$}}%.ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ$}}%8$}}%.t' 'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩIABot Sum Sum[ –ú–µ–∫—Å–∏—á–∫–∞ ariz' SumE$}}% is ' her' willmMm$}}% andxz3 d√°tummal of her a SumÔøΩ$}}%3C{6IABot Sum'sÔøΩÔøΩÔøΩÔøΩabestandenÔøΩÔøΩÔøΩ$}}%.R7Xeltemperaturen2$}}%.ÔøΩÔøΩ$}}% SumÔøΩWebachivq$}}%3$}}%C[IABot a.'neltemperaturenM$}}%'rizÔøΩ$}}%B$}}% are7 d√°tummal.fh;hcIABot Sum' Sum'ÔøΩÔøΩÔøΩ$}}% Sum aN1.$}}%riz is SumI$}}% Sum'Rl$}}%.' ' ': Sumj$}}% Sum@)*$}}% SumÔøΩ$}}% Sum Sumic$}}% Sum and Sum.y$}}%fC archiv√°lva onationkm$}}% Sum Sumjq$}}% SumdyGIABot SumD^ d√°tummal Sum Sum' Sum-", "sheation he going=yB@$}}% '  goingm the a  ': .'m.' will of for. on'ation going of. to.'ation' ' is at Sum  be 's on toation on' ' atation't of.' Sumriz ' going. for  'm.: ' ' a ' .s.'  a a'ation'  is to, ' Sum sheation to.' of. '  for. on's..' on: ' '. at ' a. tos a and. is' , ' , goingsation' onm and.' to ' of and the '  ' '  '  to's going. Sumation a ': ' a 's for.' for. the ination get.'s. Sum at: her.' 's from is to going the '  Sum of:.m and the with.' ': '  the'  ' ' ' will' 's the a: ' ': .' s's and: '..', Sum to ' is: ':  ' '.'s 's ' ' '  to' ' ' ' her a.'s ' ' '. 'm. be", "is. '  is her to to and ' the is' ationrization for will is '.'  to ' to on ': going a  ' to.' srization riz to 's: ' : '  Sumation  will she's atationrization'  she '.  the is to.ation  and ' .' .'s the will . is.  ' ' '  ' . . in  the  arization:s' ation to.m:  ',.' a will '.:s  hasriz:ssation to.' . ' '  ' '  ' '  '.'  onm's:riz ' ia on '  '  ' is '.  ' ' '  '.'s riz.sriz 't  '. '. the is '  '  ' to: to' m: to '  ' ':'  ' '  ' '  ' '  ' '  ' '  ' ' ' .' '  the will.'  ' '  's ' '  ' '  '  ' ' '  ' ' '  and ' ' '  ' '", "is ': ' Sum  ' rization to ' herÔøΩÔøΩÔøΩ$}}%m:  '  for a isriz ariz toation of'riz:m. the a Sum atriz ' a toation 'ss.t:s. the '.: will a the '.'  Sumrization to. was Sum ' 'm  '  a 'm andriz 'riz. at. '. and ' '.' 's. '.'  on in. onation aation for.': '  of be of. ' isation:ation. ' a. '  ' to '  's to is her is ' 's to : for with.' '. ':  are tos to 'm.' ' to 's: '  '' 'sation is at ' '  a.' to  has a is.'.'s.  her: ' ' ' Sum' ' '  ' a will. will ariz '  '  the with's '  on ' Sum 's for' will. is '.'.' ' of ' to ' '. ' ' ' is ' '  and ' '. '  's: ' '  's to '"]
|- single label  ["Summrization: 'Hannah needs Betty's number but Amanda doesn't have it. She needs to contact Larry.' ", "Summrization: 'Eric and Rob are going to watch a stand-up on youtube.' ", "Summrization: 'Lenny can't decide which trousers to buy. Bob advised Lenny on that topic. Lenny goes with Bob's advice to pick the trousers that are of best quality.' ", "Summrization: 'Emma will be home soon and she will let Will know.' "]
Traceback (most recent call last):‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ                                                                        | 83/205 [00:36<00:37,  3.24it/s]
  File "/home/cwtang/david_dynamo/train_gsm8k_llama.py", line 959, in <module>
    main()
  File "/home/cwtang/david_dynamo/train_gsm8k_llama.py", line 808, in main
    generated_tokens = accelerator.unwrap_model(model).generate(**gen_kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/peft/peft_model.py", line 1130, in generate
    outputs = self.base_model.generate(**kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/transformers/generation/utils.py", line 1764, in generate
    return self.sample(
  File "/home/cwtang/.local/lib/python3.10/site-packages/transformers/generation/utils.py", line 2861, in sample
    outputs = self(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 1181, in forward
    outputs = self.model(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 1068, in forward
    layer_outputs = decoder_layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 810, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 268, in forward
    down_proj = self.down_proj(self.act_fn(self.gate_proj(x)) * self.up_proj(x))
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/peft/tuners/lora/bnb.py", line 290, in forward
    result = self.base_layer(x, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/cwtang/.local/lib/python3.10/site-packages/bitsandbytes/nn/modules.py", line 256, in forward
    out = bnb.matmul_4bit(x, self.weight.t(), bias=bias, quant_state=self.weight.quant_state)
  File "/home/cwtang/.local/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py", line 577, in matmul_4bit
    return MatMul4Bit.apply(A, B, out, bias, quant_state)
  File "/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py", line 506, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/home/cwtang/.local/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py", line 516, in forward
    output = torch.nn.functional.linear(A, F.dequantize_4bit(B, quant_state).to(A.dtype).t(), bias)
KeyboardInterrupt